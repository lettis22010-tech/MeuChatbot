import{t as D,L as M,N as S,O as E,P as d,a as N,R as P,j as e,U as $,V,W as q,X as R,Y as G,l as u,a8 as H,b4 as W,r as l,b as X,c as Y,o as J,p as K,M as U,S as w,B as Q,n as k,E as F,J as Z,K as _}from"./index-B1XR3Coy.js";import{W as ee}from"./workflow_empty-BmvH5JwJ.js";import{V as te}from"./ViewHeader-jo2V0q71.js";import{E as se}from"./ErrorBoundary-WOMkE_83.js";import{S as n}from"./Skeleton-BQAmmov-.js";import{T as v}from"./Tooltip-9ICsuaYn.js";import{I as ae}from"./IconTrash-BvhWIQ6v.js";import{u as ie,C as re}from"./ConfirmDialog-Bksga_et.js";import"./StyledFab-BqTal21_.js";import"./IconSearch-BzBgax5m.js";import"./IconCopy-BBl1XuSo.js";const s=D(M)(({theme:a})=>({borderColor:a.palette.grey[900]+25,[`&.${S.head}`]:{color:a.palette.grey[900]},[`&.${S.body}`]:{fontSize:14,height:64}})),g=D(E)(()=>({"&:last-child td, &:last-child th":{border:0}})),B=({data:a,isLoading:h,filterFunction:p,handleDelete:x})=>{const c=N(),j=P(i=>i.customization);return e.jsx(e.Fragment,{children:e.jsx($,{sx:{border:1,borderColor:c.palette.grey[900]+25,borderRadius:2},component:V,children:e.jsxs(q,{sx:{minWidth:650},size:"small","aria-label":"a dense table",children:[e.jsx(R,{sx:{backgroundColor:j.isDarkMode?c.palette.common.black:c.palette.grey[100],height:56},children:e.jsxs(E,{children:[e.jsx(s,{component:"th",scope:"row",style:{width:"25%"},children:"Name"},"0"),e.jsx(s,{style:{width:"40%"},children:"Path"},"1"),e.jsx(s,{style:{width:"25%"},children:"Size"},"2"),e.jsx(s,{style:{width:"10%"},children:"Actions"},"3")]})}),e.jsx(G,{children:h?e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsx(s,{children:e.jsx(n,{variant:"text"})}),e.jsx(s,{children:e.jsx(n,{variant:"text"})}),e.jsx(s,{children:e.jsx(n,{variant:"text"})}),e.jsx(s,{children:e.jsx(n,{variant:"text"})})]}),e.jsxs(g,{children:[e.jsx(s,{children:e.jsx(n,{variant:"text"})}),e.jsx(s,{children:e.jsx(n,{variant:"text"})}),e.jsx(s,{children:e.jsx(n,{variant:"text"})}),e.jsx(s,{children:e.jsx(n,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:a==null?void 0:a.filter(p).map((i,m)=>e.jsxs(g,{children:[e.jsx(s,{children:e.jsx(v,{title:i.name,children:e.jsx(u,{sx:{display:"-webkit-box",fontSize:14,fontWeight:500,WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"ellipsis",overflow:"hidden"},children:i.name.split("/").pop()})})},"0"),e.jsx(s,{children:e.jsx(v,{title:i.path,children:e.jsx(u,{sx:{display:"-webkit-box",fontSize:14,fontWeight:500,WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"ellipsis",overflow:"hidden"},children:i.path})})},"1"),e.jsx(s,{children:e.jsx(u,{sx:{alignItems:"center",display:"flex",fontSize:".9rem",fontWeight:200},children:`${i.size.toFixed(2)} MB`})},"2"),e.jsx(s,{children:e.jsx(H,{color:"error",onClick:()=>x(i),size:"small",children:e.jsx(ae,{})})},"3")]},m))})})]})})})};B.propTypes={data:d.array,images:d.object,isLoading:d.bool,filterFunction:d.func,handleDelete:d.func};const oe=()=>W.get("/files"),ne=a=>W.delete("/files",{params:{path:a}}),T={getAllFiles:oe,deleteFile:ne},ye=()=>{const{confirm:a}=ie(),[h,p]=l.useState(!0),{error:x,setError:c}=X(),[j,i]=l.useState([]),[m,z]=l.useState(""),r=Y(T.getAllFiles),b=J();K();const y=(...t)=>b(Z(...t)),C=(...t)=>b(_(...t)),L=t=>{z(t.target.value)};function A(t){return t.name.toLowerCase().indexOf(m.toLowerCase())>-1||t.category&&t.category.toLowerCase().indexOf(m.toLowerCase())>-1}const O=async t=>{const I={title:"Delete",description:`Delete ${t.name}? This process cannot be undone.`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await a(I))try{const o=await T.deleteFile(t.path);o!=null&&o.data&&y({message:"File deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:f=>e.jsx(k,{style:{color:"white"},onClick:()=>C(f),children:e.jsx(F,{})})}}),await r.request()}catch(o){c(o),y({message:typeof o.response.data=="object"?o.response.data.message:o.response.data,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:f=>e.jsx(k,{style:{color:"white"},onClick:()=>C(f),children:e.jsx(F,{})})}})}};return l.useEffect(()=>{r.request()},[]),l.useEffect(()=>{p(r.loading)},[r.loading]),l.useEffect(()=>{if(r.data)try{const t=r.data;i(t)}catch(t){console.error(t)}},[r.data]),e.jsxs(U,{children:[x?e.jsx(se,{error:x}):e.jsxs(w,{flexDirection:"column",sx:{gap:3},children:[e.jsx(te,{onSearchChange:L,search:!0,searchPlaceholder:"Search File",title:"Files"}),e.jsx(B,{data:j,filterFunction:A,handleDelete:O,isLoading:h}),!h&&(!r.data||r.data.length===0)&&e.jsxs(w,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(Q,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"25vh",width:"auto"},src:ee,alt:"WorkflowEmptySVG"})}),e.jsx("div",{children:"No Files Yet"})]})]}),e.jsx(re,{})]})};export{ye as default};
