import{t as Y,L as oe,N as T,O as $,a as ne,R as le,o as de,p as ce,b as me,r as a,c as A,at as pe,j as e,M as he,S as B,e as xe,B as j,U as je,V as Ce,W as ge,X as ue,Y as fe,d as Se,_ as M,$ as C,n as L,E as R,J as ye,K as De}from"./index-B1XR3Coy.js";import{k as be,C as we,A as ke,c as g}from"./CredentialListDialog-ooDI7A-3.js";import{u as Pe,C as Ee}from"./ConfirmDialog-Bksga_et.js";import{V as ve}from"./ViewHeader-jo2V0q71.js";import{E as Ie}from"./ErrorBoundary-WOMkE_83.js";import{S as Ne}from"./ShareWithWorkspaceDialog-C6kxG_F7.js";import{I as Te}from"./IconPlus-DpyX5kZB.js";import{S as r}from"./Skeleton-BQAmmov-.js";import{I as Ae}from"./IconShare-DiLHmK0B.js";import{I as Be}from"./IconSearch-BzBgax5m.js";import{I as Me}from"./IconTrash-BvhWIQ6v.js";import"./TooltipWithParser-C72LCUcD.js";import"./index-D--Rb2MU.js";import"./Tooltip-9ICsuaYn.js";import"./Dropdown-BH_BuIwh.js";import"./Autocomplete-2B99MXTa.js";import"./Close-CA_iFeNy.js";import"./FormControl-Cb0ROeST.js";import"./TextField-BEeUeVUl.js";import"./InputLabel-HPVYUEFn.js";import"./Input-C2v4FwXn.js";import"./ListItem-C9nlU6HX.js";import"./Switch-BtbcRzr_.js";import"./main-BBsr8sqY.js";import"./IconArrowsMaximize-BrsSDZNx.js";import"./IconAlertTriangle-Bdlxpe5D.js";import"./InputAdornment-D6_duzKN.js";import"./StyledFab-BqTal21_.js";import"./IconCopy-BBl1XuSo.js";import"./Grid-DtMOPoeK.js";import"./toPropertyKey-hKuLU48H.js";import"./createStyled-BzRwilhm.js";import"./KeyboardArrowRight-KQTKBFVE.js";import"./LastPage-CMvObEkB.js";const Le="/assets/credential_empty-BUL4Jfyn.svg",s=Y(oe)(({theme:i})=>({borderColor:i.palette.grey[900]+25,padding:"6px 16px",[`&.${T.head}`]:{color:i.palette.grey[900]},[`&.${T.body}`]:{fontSize:14,height:64}})),u=Y($)(()=>({"&:last-child td, &:last-child th":{border:0}})),Ct=()=>{const i=ne(),f=le(t=>t.customization),d=de();ce();const{error:S,setError:y}=me(),D=(...t)=>d(ye(...t)),b=(...t)=>d(De(...t)),[w,F]=a.useState(!0),[H,c]=a.useState(!1),[V,q]=a.useState({}),[k,m]=a.useState(!1),[O,P]=a.useState({}),[E,U]=a.useState([]),[W,_]=a.useState([]),[v,I]=a.useState(!1),[z,G]=a.useState({}),{confirm:J}=Pe(),o=A(g.getAllCredentials),l=A(g.getAllComponentsCredentials),[X,K]=a.useState(""),Q=t=>{K(t.target.value)};function Z(t){return t.credentialName.toLowerCase().indexOf(X.toLowerCase())>-1}const ee=()=>{q({title:"Add New Credential",componentsCredentials:W}),c(!0)},te=t=>{P({type:"ADD",cancelButtonName:"Cancel",confirmButtonName:"Add",credentialComponent:t}),m(!0)},se=t=>{P({type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Save",data:t}),m(!0)},ae=t=>{const n={type:"EDIT",cancelButtonName:"Cancel",confirmButtonName:"Share",data:{id:t.id,name:t.name,title:"Share Credential",itemType:"credential"}};G(n),I(!0)},re=async t=>{const n={title:"Delete",description:`Delete credential ${t.name}?`,confirmButtonName:"Delete",cancelButtonName:"Cancel"};if(await J(n))try{(await g.deleteCredential(t.id)).data&&(D({message:"Credential deleted",options:{key:new Date().getTime()+Math.random(),variant:"success",action:x=>e.jsx(L,{style:{color:"white"},onClick:()=>b(x),children:e.jsx(R,{})})}}),N())}catch(h){D({message:`Failed to delete Credential: ${typeof h.response.data=="object"?h.response.data.message:h.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:x=>e.jsx(L,{style:{color:"white"},onClick:()=>b(x),children:e.jsx(R,{})})}})}},ie=t=>{c(!1),te(t)},N=()=>{c(!1),m(!1),o.request()};return a.useEffect(()=>{o.request(),l.request()},[]),a.useEffect(()=>{F(o.loading)},[o.loading]),a.useEffect(()=>{o.data&&U(o.data)},[o.data]),a.useEffect(()=>{l.data&&(_(l.data),d({type:pe,componentsCredentials:l.data}))},[l.data,d]),e.jsxs(e.Fragment,{children:[e.jsx(he,{children:S?e.jsx(Ie,{error:S}):e.jsxs(B,{flexDirection:"column",sx:{gap:3},children:[e.jsx(ve,{onSearchChange:Q,search:!0,searchPlaceholder:"Search Credentials",title:"Credentials",description:"API keys, tokens, and secrets for 3rd party integrations",children:e.jsx(xe,{permissionId:"credentials:create",variant:"contained",sx:{borderRadius:2,height:"100%"},onClick:ee,startIcon:e.jsx(Te,{}),children:"Add Credential"})}),!w&&E.length<=0?e.jsxs(B,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[e.jsx(j,{sx:{p:2,height:"auto"},children:e.jsx("img",{style:{objectFit:"cover",height:"16vh",width:"auto"},src:Le,alt:"CredentialEmptySVG"})}),e.jsx("div",{children:"No Credentials Yet"})]}):e.jsx(je,{sx:{border:1,borderColor:i.palette.grey[900]+25,borderRadius:2},component:Ce,children:e.jsxs(ge,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(ue,{sx:{backgroundColor:f.isDarkMode?i.palette.common.black:i.palette.grey[100],height:56},children:e.jsxs($,{children:[e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Last Updated"}),e.jsx(s,{children:"Created"}),e.jsx(s,{style:{width:"5%"},children:" "}),e.jsx(s,{style:{width:"5%"},children:" "}),e.jsx(s,{style:{width:"5%"},children:" "})]})}),e.jsx(fe,{children:w?e.jsxs(e.Fragment,{children:[e.jsxs(u,{children:[e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})})]}),e.jsxs(u,{children:[e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})}),e.jsx(s,{children:e.jsx(r,{variant:"text"})})]})]}):e.jsx(e.Fragment,{children:E.filter(Z).map((t,n)=>e.jsxs(u,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(s,{scope:"row",children:e.jsxs(j,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[e.jsx(j,{sx:{width:35,height:35,borderRadius:"50%",backgroundColor:f.isDarkMode?i.palette.common.white:i.palette.grey[300]+75},children:e.jsx("img",{style:{width:"100%",height:"100%",padding:5,objectFit:"contain"},alt:t.credentialName,src:`${Se}/api/v1/components-credentials-icon/${t.credentialName}`,onError:p=>{p.target.onerror=null,p.target.style.padding="5px",p.target.src=be}})}),t.name]})}),e.jsx(s,{children:M(t.updatedDate).format("MMMM Do, YYYY HH:mm:ss")}),e.jsx(s,{children:M(t.createdDate).format("MMMM Do, YYYY HH:mm:ss")}),!t.shared&&e.jsxs(e.Fragment,{children:[e.jsx(s,{children:e.jsx(C,{permissionId:"credentials:share",display:"feat:workspaces",title:"Share",color:"primary",onClick:()=>ae(t),children:e.jsx(Ae,{})})}),e.jsx(s,{children:e.jsx(C,{permissionId:"credentials:create,credentials:update",title:"Edit",color:"primary",onClick:()=>se(t),children:e.jsx(Be,{})})}),e.jsx(s,{children:e.jsx(C,{permissionId:"credentials:delete",title:"Delete",color:"error",onClick:()=>re(t),children:e.jsx(Me,{})})})]}),t.shared&&e.jsx(e.Fragment,{children:e.jsx(s,{colSpan:"3",children:"Shared Credential"})})]},n))})})]})})]})}),e.jsx(we,{show:H,dialogProps:V,onCancel:()=>c(!1),onCredentialSelected:ie}),k&&e.jsx(ke,{show:k,dialogProps:O,onCancel:()=>m(!1),onConfirm:N,setError:y}),v&&e.jsx(Ne,{show:v,dialogProps:z,onCancel:()=>I(!1),setError:y}),e.jsx(Ee,{})]})};export{Ct as default};
