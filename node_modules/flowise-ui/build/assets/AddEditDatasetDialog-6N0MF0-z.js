import{P as u,o as H,p as W,r as i,q as G,H as C,j as e,D as M,h as $,b5 as V,k as _,B as v,l as w,a1 as T,m as q,n as o,aa as z,s as L,E as D,J,K}from"./index-B1XR3Coy.js";import{C as U}from"./ConfirmDialog-Bksga_et.js";import{F as X}from"./File-B2PWlg1I.js";import{S as Q}from"./Switch-BtbcRzr_.js";import{T as Y}from"./TooltipWithParser-C72LCUcD.js";import{d as k}from"./dataset-gYqR4wmQ.js";const Z=`Only the first 2 columns will be considered:
----------------------------
| Input      | Output      |
----------------------------
| test input | test output |
----------------------------
`,P=({show:r,dialogProps:s,onCancel:l,onConfirm:b})=>{const E=document.getElementById("portal"),n=H();W();const c=(...t)=>n(J(...t)),d=(...t)=>n(K(...t)),[p,x]=i.useState(""),[h,m]=i.useState(""),[S,y]=i.useState("ADD"),[I,f]=i.useState({}),[A,N]=i.useState(!1),[j,F]=i.useState();i.useEffect(()=>(s.type==="EDIT"&&s.data?(x(s.data.name),m(s.data.description),y("EDIT"),f(s.data)):s.type==="ADD"&&(x(""),m(""),y("ADD"),f({})),()=>{x(""),m(""),y("ADD"),f({})}),[s]),i.useEffect(()=>(n(r?{type:G}:{type:C}),()=>n({type:C})),[r,n]);const R=async()=>{try{const t={name:p,description:h};j&&(t.firstRowHeaders=A,t.csvFile=j);const a=await k.createDataset(t);a.data&&(c({message:"New Dataset added",options:{key:new Date().getTime()+Math.random(),variant:"success",action:g=>e.jsx(o,{style:{color:"white"},onClick:()=>d(g),children:e.jsx(D,{})})}}),b(a.data.id))}catch(t){c({message:`Failed to add new Dataset: ${typeof t.response.data=="object"?t.response.data.message:t.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:a=>e.jsx(o,{style:{color:"white"},onClick:()=>d(a),children:e.jsx(D,{})})}}),l()}},O=async()=>{try{const t={name:p,description:h},a=await k.updateDataset(I.id,t);a.data&&(c({message:"Dataset saved",options:{key:new Date().getTime()+Math.random(),variant:"success",action:g=>e.jsx(o,{style:{color:"white"},onClick:()=>d(g),children:e.jsx(D,{})})}}),b(a.data.id))}catch(t){c({message:`Failed to save Dataset: ${typeof t.response.data=="object"?t.response.data.message:t.response.data}`,options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:a=>e.jsx(o,{style:{color:"white"},onClick:()=>d(a),children:e.jsx(D,{})})}}),l()}},B=r?e.jsxs(M,{fullWidth:!0,maxWidth:"sm",open:r,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx($,{sx:{fontSize:"1rem"},id:"alert-dialog-title",children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e.jsx(V,{style:{marginRight:"10px"}}),s.type==="ADD"?"Add Dataset":"Edit Dataset"]})}),e.jsxs(_,{children:[e.jsxs(v,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(w,{children:["Name",e.jsx("span",{style:{color:"red"},children:"Â *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(T,{size:"small",sx:{mt:1},type:"string",fullWidth:!0,onChange:t=>x(t.target.value),value:p??""},"datasetName")]}),e.jsxs(v,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsx(w,{children:"Description"}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(T,{size:"small",sx:{mt:1},type:"string",fullWidth:!0,multiline:!0,rows:4,onChange:t=>m(t.target.value),value:h??""},"datasetDescription")]}),S==="ADD"&&e.jsxs(v,{sx:{p:2},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs(w,{children:["Upload CSV",e.jsx(Y,{style:{mb:1,mt:2},title:`<pre>${Z}</pre>`})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(X,{disabled:!1,fileType:".csv",onChange:t=>F(t),value:j??"Choose a file to upload"}),e.jsx(Q,{value:A,onChange:N,label:"Treat First Row as headers in the upload file?"})]})]}),e.jsxs(q,{children:[e.jsx(o,{onClick:()=>l(),children:s.cancelButtonName}),e.jsx(z,{disabled:!p,variant:"contained",onClick:()=>S==="ADD"?R():O(),children:s.confirmButtonName})]}),e.jsx(U,{})]}):null;return L.createPortal(B,E)};P.propTypes={show:u.bool,dialogProps:u.object,onCancel:u.func,onConfirm:u.func};export{P as A};
