import{u as Q,a as X,r,b as Z,c as tt,d as et,j as t,M as ot,S as F,T as P,I as at,e as rt,B as x,g as N}from"./index-B1XR3Coy.js";import{I as st}from"./ItemCard-DFH1pXJi.js";import{W as it}from"./workflow_empty-BmvH5JwJ.js";import{C as nt}from"./ConfirmDialog-Bksga_et.js";import{F as lt}from"./FlowListTable-2fPyxK1Q.js";import{V as ct}from"./ViewHeader-jo2V0q71.js";import{E as mt}from"./ErrorBoundary-WOMkE_83.js";import{D as dt,T as pt}from"./TablePagination-Dfhg7VLc.js";import{c as gt}from"./chatflows-ITLPd47E.js";import{T as ut}from"./ToggleButtonGroup-D1WH89Fe.js";import{I as ft}from"./IconLayoutGrid-DAeG3wjO.js";import{I as ht}from"./IconPlus-DpyX5kZB.js";import{S as w}from"./Skeleton-BQAmmov-.js";import"./Tooltip-9ICsuaYn.js";import"./Edit-BFCL8ZvY.js";import"./Delete-CvnCkEIf.js";import"./SaveChatflowDialog-C2LCggZV.js";import"./TextField-BEeUeVUl.js";import"./FormControl-Cb0ROeST.js";import"./InputLabel-HPVYUEFn.js";import"./SpeechToText-BX3-pddK.js";import"./IconBulb-CwCq2_I0.js";import"./InputAdornment-D6_duzKN.js";import"./IconTrash-BvhWIQ6v.js";import"./Switch-BtbcRzr_.js";import"./TooltipWithParser-C72LCUcD.js";import"./index-D--Rb2MU.js";import"./CredentialInputHandler-NSWgGX5U.js";import"./CredentialListDialog-ooDI7A-3.js";import"./Dropdown-BH_BuIwh.js";import"./Autocomplete-2B99MXTa.js";import"./Close-CA_iFeNy.js";import"./Input-C2v4FwXn.js";import"./ListItem-C9nlU6HX.js";import"./main-BBsr8sqY.js";import"./IconArrowsMaximize-BrsSDZNx.js";import"./IconAlertTriangle-Bdlxpe5D.js";import"./IconSearch-BzBgax5m.js";import"./ExportAsTemplateDialog-CN3tapJC.js";import"./TableSortLabel-DZVq0i6E.js";import"./StyledFab-BqTal21_.js";import"./IconCopy-BBl1XuSo.js";import"./Pagination-DyTukyc1.js";import"./LastPage-CMvObEkB.js";const le=()=>{var L,b,E,I,T,D,k;const j=Q(),i=X(),[m,B]=r.useState(!0),[C,R]=r.useState({}),[p,M]=r.useState(""),{error:S,setError:G}=Z(),a=tt(gt.getAllChatflows),[g,V]=r.useState(localStorage.getItem("flowDisplayStyle")||"card"),[u,O]=r.useState(1),[f,W]=r.useState(dt),[h,_]=r.useState(0),$=(e,o)=>{O(e),W(o),y(e,o)},y=(e,o)=>{const s={page:e||u,limit:o||f};a.request(s)},z=(e,o)=>{o!==null&&(localStorage.setItem("flowDisplayStyle",o),V(o))},H=e=>{M(e.target.value)};function v(e){return(e==null?void 0:e.name.toLowerCase().indexOf(p.toLowerCase()))>-1||e.category&&e.category.toLowerCase().indexOf(p.toLowerCase())>-1||(e==null?void 0:e.id.toLowerCase().indexOf(p.toLowerCase()))>-1}const U=()=>{j("/canvas")},q=e=>{j(`/canvas/${e.id}`)};return r.useEffect(()=>{y(u,f)},[]),r.useEffect(()=>{B(a.loading)},[a.loading]),r.useEffect(()=>{var e,o;if(a.data)try{const s=(e=a.data)==null?void 0:e.data,J=(o=a.data)==null?void 0:o.total;_(J);const d={};for(let n=0;n<s.length;n+=1){const Y=s[n].flowData,c=JSON.parse(Y).nodes||[];d[s[n].id]=[];for(let l=0;l<c.length;l+=1){if(c[l].data.name==="stickyNote"||c[l].data.name==="stickyNoteAgentflow")continue;const A=`${et}/api/v1/node-icon/${c[l].data.name}`;d[s[n].id].some(K=>K.imageSrc===A)||d[s[n].id].push({imageSrc:A,label:c[l].data.label})}}R(d)}catch(s){console.error(s)}},[a.data]),t.jsxs(ot,{children:[S?t.jsx(mt,{error:S}):t.jsxs(F,{flexDirection:"column",sx:{gap:3},children:[t.jsxs(ct,{onSearchChange:H,search:!0,searchPlaceholder:"Search Name or Category",title:"Chatflows",description:"Build single-agent systems, chatbots and simple LLM flows",children:[t.jsxs(ut,{sx:{borderRadius:2,maxHeight:40},value:g,color:"primary",disabled:h===0,exclusive:!0,onChange:z,children:[t.jsx(P,{sx:{borderColor:i.palette.grey[900]+25,borderRadius:2,color:(L=i==null?void 0:i.customization)!=null&&L.isDarkMode?"white":"inherit"},variant:"contained",value:"card",title:"Card View",children:t.jsx(ft,{})}),t.jsx(P,{sx:{borderColor:i.palette.grey[900]+25,borderRadius:2,color:(b=i==null?void 0:i.customization)!=null&&b.isDarkMode?"white":"inherit"},variant:"contained",value:"list",title:"List View",children:t.jsx(at,{})})]}),t.jsx(rt,{permissionId:"chatflows:create",variant:"contained",onClick:U,startIcon:t.jsx(ht,{}),sx:{borderRadius:2,height:40},children:"Add New"})]}),m&&t.jsxs(x,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:N,children:[t.jsx(w,{variant:"rounded",height:160}),t.jsx(w,{variant:"rounded",height:160}),t.jsx(w,{variant:"rounded",height:160})]}),!m&&h>0&&t.jsxs(t.Fragment,{children:[!g||g==="card"?t.jsx(x,{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:N,children:(I=(E=a.data)==null?void 0:E.data)==null?void 0:I.filter(v).map((e,o)=>t.jsx(st,{onClick:()=>q(e),data:e,images:C[e.id]},o))}):t.jsx(lt,{data:(T=a.data)==null?void 0:T.data,images:C,isLoading:m,filterFunction:v,updateFlowsApi:a,setError:G}),t.jsx(pt,{currentPage:u,limit:f,total:h,onChange:$})]}),!m&&(!((D=a.data)!=null&&D.data)||((k=a.data)==null?void 0:k.data.length)===0)&&t.jsxs(F,{sx:{alignItems:"center",justifyContent:"center"},flexDirection:"column",children:[t.jsx(x,{sx:{p:2,height:"auto"},children:t.jsx("img",{style:{objectFit:"cover",height:"25vh",width:"auto"},src:it,alt:"WorkflowEmptySVG"})}),t.jsx("div",{children:"No Chatflows Yet"})]})]}),t.jsx(nt,{})]})};export{le as default};
