import{p as R,b as T,o as z,R as D,r,c as M,j as e,M as G,S as k,B as o,aa as W,g as q,l,a1 as p,av as P,bi as F,bj as O,n as C,E as U,J as _,K as L}from"./index-B1XR3Coy.js";import{E as Y}from"./ErrorBoundary-WOMkE_83.js";import{V as $}from"./ViewHeader-jo2V0q71.js";import{S as H}from"./settings-ClEiD2Lp.js";import{B as J}from"./BackdropLoader-C982mQas.js";import{v as K}from"./validation-DNbaeON5.js";import{I as X}from"./IconAlertTriangle-Bdlxpe5D.js";import"./IconCopy-BBl1XuSo.js";import"./StyledFab-BqTal21_.js";import"./IconSearch-BzBgax5m.js";const le=()=>{R();const{error:g,setError:V}=T(),y=z(),w=(...s)=>y(_(...s)),v=(...s)=>y(L(...s)),u=D(s=>s.auth.user),B=D(s=>s.auth.isAuthenticated),[i,A]=r.useState(""),[x,I]=r.useState(""),[h,S]=r.useState(""),[f,b]=r.useState(""),[E,n]=r.useState(!1),[m,d]=r.useState([]),t=M(P.getUserById),N=async()=>{const s=[];if(d([]),B||s.push("User is not authenticated"),u.isSSO&&s.push("User is a SSO user, unable to update details"),h||s.push("Name cannot be left blank!"),f||s.push("Email cannot be left blank!"),i||x){i!==x&&s.push("New Password and Confirm Password do not match");const a=K(i);a.length>0&&s.push(...a)}if(s.length>0){d(s);return}const c={id:u.id,email:f,name:h};i&&(c.password=i),n(!0);try{const a=await P.updateUser(c);d([]),n(!1),a.data&&(F.dispatch(O(a.data)),w({message:"User Details Updated!",options:{key:new Date().getTime()+Math.random(),variant:"success",action:j=>e.jsx(C,{style:{color:"white"},onClick:()=>v(j),children:e.jsx(U,{})})}}))}catch(a){n(!1),d([typeof a.response.data=="object"?a.response.data.message:a.response.data]),w({message:"Failed to update user details",options:{key:new Date().getTime()+Math.random(),variant:"error",persist:!0,action:j=>e.jsx(C,{style:{color:"white"},onClick:()=>v(j),children:e.jsx(U,{})})}})}};return r.useEffect(()=>{if(t.data){const s=t.data;b(s.email),S(s.name),n(!1)}},[t.data]),r.useEffect(()=>{t.error&&(n(!1),V(t.error))},[t.error]),r.useEffect(()=>{n(!0),t.request(u.id)},[]),e.jsxs(e.Fragment,{children:[e.jsx(G,{children:g?e.jsx(Y,{error:g}):e.jsxs(k,{flexDirection:"column",sx:{gap:3},children:[e.jsx($,{search:!1,title:"Settings"}),m&&m.length>0&&e.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"row",alignItems:"center",borderRadius:10,background:"rgb(254,252,191)",padding:10,paddingTop:15,marginTop:10,marginBottom:10},children:[e.jsx(o,{sx:{p:2},children:e.jsx(X,{size:25,color:"orange"})}),e.jsx(k,{flexDirection:"column",children:e.jsx("span",{style:{color:"rgb(116,66,16)"},children:e.jsx("ul",{children:m.map((s,c)=>e.jsx("strong",{children:e.jsx("li",{children:s})},c))})})})]}),e.jsx(H,{action:e.jsx(W,{variant:"contained",style:{borderRadius:2,height:40},onClick:N,children:"Save"}),title:"Profile",children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:q,px:2.5,py:2},children:[e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsx(l,{children:"Email"}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(p,{id:"email",type:"string",fullWidth:!0,size:"small",placeholder:"Your login Id",name:"name",onChange:s=>b(s.target.value),value:f})]}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(l,{children:["Full Name",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(p,{id:"name",type:"string",fullWidth:!0,size:"small",placeholder:"Your Name",name:"name",onChange:s=>S(s.target.value),value:h})]}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(l,{children:["New Password",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(p,{id:"np",type:"password",fullWidth:!0,size:"small",name:"new_password",onChange:s=>A(s.target.value),value:i}),e.jsx(l,{variant:"caption",children:e.jsx("i",{children:"Password must be at least 8 characters long and contain at least one lowercase letter, one uppercase letter, one digit, and one special character."})})]}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(l,{children:["Confirm Password",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(p,{id:"npc",type:"password",fullWidth:!0,size:"small",name:"new_cnf_password",onChange:s=>I(s.target.value),value:x}),e.jsx(l,{variant:"caption",children:e.jsx("i",{children:"Retype your new password. Must match the password typed above."})})]})]})})]})}),E&&e.jsx(J,{open:E})]})};export{le as default};
