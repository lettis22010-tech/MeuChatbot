import{a as T,r as a,c as f,j as t,B as g,ag as y,w as A,S as E,l as p,d as v}from"./index-B1XR3Coy.js";import{i as I}from"./index-4nfsl_Py.js";import{c as m}from"./chatflows-ITLPd47E.js";import{I as L}from"./IconCircleXFilled-eMwzVwFM.js";const k=()=>{const r=document.location.pathname.toString().split("/"),u=r[r.length-1]==="chatbot"?"":r[r.length-1],c=T(),[l,x]=a.useState(null),[C,h]=a.useState({}),[w,b]=a.useState(!0),[S,d]=a.useState({}),o=f(m.getSpecificChatflowFromPublicEndpoint),i=f(m.getSpecificChatflow);return a.useEffect(()=>{o.request(u)},[]),a.useEffect(()=>{if(o.data||i.data){const s=o.data||i.data;x(s);const n=s.type;if(s.chatbotConfig){let e={};(n==="MULTIAGENT"||n==="AGENTFLOW")&&(e.showAgentMessages=!0);try{e={...e,...JSON.parse(s.chatbotConfig)},h(e),e.overrideConfig&&d(e.overrideConfig),e.generateNewSession&&localStorage.removeItem(`${s.id}_EXTERNAL`)}catch(j){console.error(j),h(e),d({})}}else(n==="MULTIAGENT"||n==="AGENTFLOW")&&h({showAgentMessages:!0})}},[o.data,i.data]),a.useEffect(()=>{b(o.loading||i.loading)},[o.loading,i.loading]),t.jsx(t.Fragment,{children:w?null:t.jsx(t.Fragment,{children:!l||l.apikeyid?t.jsx(g,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:t.jsx(g,{sx:{maxWidth:"500px",width:"100%"},children:t.jsx(y,{variant:"outlined",sx:{border:`1px solid ${c.palette.error.main}`,borderRadius:2,padding:"20px",boxShadow:`0 4px 8px ${A(c.palette.error.main,.15)}`},children:t.jsxs(E,{spacing:2,alignItems:"center",children:[t.jsx(L,{size:50,color:c.palette.error.main}),t.jsx(p,{variant:"h3",color:"error.main",align:"center",children:"Invalid Chatbot"}),t.jsx(p,{variant:"body1",color:"text.secondary",align:"center",children:"The chatbot you're looking for doesn't exist or requires API key authentication."})]})})})}):t.jsx(I,{chatflowid:l.id,apiHost:v,chatflowConfig:S,theme:{chatWindow:C}})})})};export{k as default};
