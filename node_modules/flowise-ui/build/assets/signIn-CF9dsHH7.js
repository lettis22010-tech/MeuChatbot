import{a as $,R as J,p as Z,b7 as _,r as t,c as f,u as K,cS as Q,bi as v,da as X,cT as O,j as e,M as Y,S as x,n as g,l,Z as I,B as D,z as ee,bh as se}from"./index-B1XR3Coy.js";import{I as G}from"./Input-C2v4FwXn.js";import{a as te}from"./auth-w0XUAhtD.js";import{A as re,G as ae,a as ie,l as oe}from"./auth0-C7knQvrB.js";import{s as ne}from"./sso-Crogm5cK.js";import{G as le}from"./github-BtlA98as.js";import{A as U,I as ce}from"./IconExclamationCircle-BsAK4qbB.js";import{L as de}from"./LoadingButton-BHZSG_sF.js";import{I as j}from"./Icon-BOcLJSmQ.js";import"./ListItem-C9nlU6HX.js";import"./FormControl-Cb0ROeST.js";import"./Close-CA_iFeNy.js";const Ie=()=>{const n=$();J(s=>s.customization),Z();const{isEnterpriseLicensed:k,isCloud:b,isOpenSource:M}=_(),V={label:"Username",name:"username",type:"email",placeholder:"user@company.com"},B={label:"Password",name:"password",type:"password",placeholder:"********"},[S,W]=t.useState(""),[A,q]=t.useState(""),[r,H]=t.useState([]),[u,d]=t.useState(void 0),[z,y]=t.useState(!1),[P,w]=t.useState(!1),[E,R]=t.useState(""),a=f(te.login),o=f(ne.ssoLogin),h=f(oe.getDefaultLoginMethods),L=K(),p=Q(),F=f(se.resendVerificationEmail),N=s=>{s.preventDefault(),y(!0);const i={email:S,password:A};a.request(i)};t.useEffect(()=>{a.error&&(y(!1),a.error.response.status===401&&a.error.response.data.redirectUrl?window.location.href=a.error.response.data.data.redirectUrl:d(a.error.response.data.message))},[a.error]),t.useEffect(()=>{v.dispatch(X()),M||h.request()},[]),t.useEffect(()=>{const i=new URLSearchParams(p.search).get("error");if(!i)return;const c=JSON.parse(decodeURIComponent(i));d(c.message)},[p.search]),t.useEffect(()=>{var s;a.data&&(y(!1),v.dispatch(O(a.data)),L(((s=p.state)==null?void 0:s.path)||"/chatflows"))},[a.data]),t.useEffect(()=>{var s;o.data&&(v.dispatch(O(o.data)),L(((s=p.state)==null?void 0:s.path)||"/chatflows"))},[o.data]),t.useEffect(()=>{var s,i,c,C;o.error&&(((i=(s=o.error)==null?void 0:s.response)==null?void 0:i.status)===401&&((C=(c=o.error)==null?void 0:c.response)!=null&&C.data.redirectUrl)?window.location.href=o.error.response.data.redirectUrl:d(o.error.message))},[o.error]),t.useEffect(()=>{h.data&&h.data.providers&&H(h.data.providers.map(s=>s))},[h.data]),t.useEffect(()=>{w(u==="User Email Unverified")},[u]);const m=s=>{window.location.href=`/api/v1/${s}/login`},T=async()=>{var s,i;try{await F.request({email:S}),d(void 0),R("Verification email has been sent successfully."),w(!1)}catch(c){d(((i=(s=c.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to send verification email.")}};return e.jsx(e.Fragment,{children:e.jsx(Y,{maxWidth:"sm",children:e.jsxs(x,{flexDirection:"column",sx:{width:"480px",gap:3},children:[E&&e.jsx(U,{variant:"filled",severity:"success",onClose:()=>R(""),children:E}),u&&e.jsx(U,{icon:e.jsx(ce,{}),variant:"filled",severity:"error",children:u}),P&&e.jsx(x,{sx:{gap:1},children:e.jsx(g,{variant:"text",onClick:T,children:"Resend Verification Email"})}),e.jsxs(x,{sx:{gap:1},children:[e.jsx(l,{variant:"h1",children:"Sign In"}),b&&e.jsxs(l,{variant:"body2",sx:{color:n.palette.grey[600]},children:["Don't have an account?"," ",e.jsx(I,{style:{color:`${n.palette.primary.main}`},to:"/register",children:"Sign up for free"}),"."]}),k&&e.jsxs(l,{variant:"body2",sx:{color:n.palette.grey[600]},children:["Have an invite code?"," ",e.jsx(I,{style:{color:`${n.palette.primary.main}`},to:"/register",children:"Sign up for an account"}),"."]})]}),e.jsx("form",{onSubmit:N,children:e.jsxs(x,{sx:{width:"100%",flexDirection:"column",alignItems:"left",justifyContent:"center",gap:2},children:[e.jsxs(D,{sx:{p:0},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(l,{children:["Email",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(G,{inputParam:V,onChange:s=>W(s),value:S,showDialog:!1})]}),e.jsxs(D,{sx:{p:0},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[e.jsxs(l,{children:["Password",e.jsx("span",{style:{color:"red"},children:" *"})]}),e.jsx("div",{style:{flexGrow:1}})]}),e.jsx(G,{inputParam:B,onChange:s=>q(s),value:A}),e.jsx(l,{variant:"body2",sx:{color:n.palette.grey[600],mt:1,textAlign:"right"},children:e.jsx(I,{style:{color:n.palette.primary.main},to:"/forgot-password",children:"Forgot password?"})}),b&&e.jsx(l,{variant:"body2",sx:{color:n.palette.grey[600],mt:1,textAlign:"right"},children:e.jsx("a",{href:"https://docs.flowiseai.com/migration-guide/cloud-migration",target:"_blank",rel:"noopener noreferrer",style:{color:n.palette.primary.main},children:"Migrate from existing account?"})})]}),e.jsx(de,{loading:z,variant:"contained",style:{borderRadius:12,height:40,marginRight:5},type:"submit",children:"Login"}),r&&r.length>0&&e.jsx(ee,{sx:{width:"100%"},children:"OR"}),r&&r.map(s=>s==="azure"&&e.jsx(g,{variant:"outlined",style:{borderRadius:12,height:45,marginRight:5,lineHeight:0},onClick:()=>m(s),startIcon:e.jsx(j,{children:e.jsx("img",{src:re,alt:"MicrosoftSSO",width:20,height:20})}),children:"Sign In With Microsoft"},s)),r&&r.map(s=>s==="google"&&e.jsx(g,{variant:"outlined",style:{borderRadius:12,height:45,marginRight:5,lineHeight:0},onClick:()=>m(s),startIcon:e.jsx(j,{children:e.jsx("img",{src:ae,alt:"GoogleSSO",width:20,height:20})}),children:"Sign In With Google"},s)),r&&r.map(s=>s==="auth0"&&e.jsx(g,{variant:"outlined",style:{borderRadius:12,height:45,marginRight:5,lineHeight:0},onClick:()=>m(s),startIcon:e.jsx(j,{children:e.jsx("img",{src:ie,alt:"Auth0SSO",width:20,height:20})}),children:"Sign In With Auth0 by Okta"},s)),r&&r.map(s=>s==="github"&&e.jsx(g,{variant:"outlined",style:{borderRadius:12,height:45,marginRight:5,lineHeight:0},onClick:()=>m(s),startIcon:e.jsx(j,{children:e.jsx("img",{src:le,alt:"GithubSSO",width:20,height:20})}),children:"Sign In With Github"},s))]})})]})})})};export{Ie as default};
