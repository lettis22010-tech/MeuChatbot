"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ExperimentalMomentoLocalMiddlewareRequestHandler = exports.ExperimentalMomentoLocalTestConfigMiddleware = void 0;
const momento_error_code_metadata_converter_1 = require("../retry/momento-error-code-metadata-converter");
const momento_rpc_method_1 = require("../retry/momento-rpc-method");
class ExperimentalMomentoLocalMiddlewareRequestHandler {
    constructor(metadata) {
        this.metadata = metadata;
    }
    onRequestBody(request) {
        return Promise.resolve(request);
    }
    onRequestMetadata(metadata) {
        const grpcMetadata = metadata._grpcMetadata;
        for (const [key, value] of Object.entries(this.metadata)) {
            this.setGrpcMetadata(grpcMetadata, key, value);
        }
        return Promise.resolve(metadata);
    }
    onResponseMetadata(metadata) {
        return Promise.resolve(metadata);
    }
    onResponseBody(response) {
        return Promise.resolve(response);
    }
    onResponseStatus(status) {
        return Promise.resolve(status);
    }
    setGrpcMetadata(metadata, key, value) {
        if (value === undefined)
            return;
        let convertedKey;
        let convertedValue;
        switch (key) {
            case 'requestId':
                convertedKey = 'request-id';
                convertedValue = value;
                break;
            case 'returnError':
                convertedKey = 'return-error';
                convertedValue = momento_error_code_metadata_converter_1.MomentoErrorCodeMetadataConverter.convert(value);
                break;
            case 'errorRpcs':
                convertedKey = 'error-rpcs';
                convertedValue = value
                    .map(rpcMethod => momento_rpc_method_1.MomentoRPCMethodMetadataConverter.convert(rpcMethod))
                    .join(' ');
                break;
            case 'errorCount':
                convertedKey = 'error-count';
                convertedValue = value.toString();
                break;
            case 'delayRpcs':
                convertedKey = 'delay-rpcs';
                convertedValue = value
                    .map(rpcMethod => momento_rpc_method_1.MomentoRPCMethodMetadataConverter.convert(rpcMethod))
                    .join(' ');
                break;
            case 'delayMs':
                convertedKey = 'delay-ms';
                convertedValue = value.toString();
                break;
            case 'delayCount':
                convertedKey = 'delay-count';
                convertedValue = value.toString();
                break;
            case 'streamErrorRpcs':
                convertedKey = 'stream-error-rpcs';
                convertedValue = value
                    .map(rpcMethod => momento_rpc_method_1.MomentoRPCMethodMetadataConverter.convert(rpcMethod))
                    .join(' ');
                break;
            case 'streamError':
                convertedKey = 'stream-error';
                convertedValue = value;
                break;
            case 'streamErrorMessageLimit':
                convertedKey = 'stream-error-message-limit';
                convertedValue = value.toString();
                break;
            default:
                convertedKey = key;
                convertedValue = value;
        }
        metadata.set(convertedKey, convertedValue);
    }
}
exports.ExperimentalMomentoLocalMiddlewareRequestHandler = ExperimentalMomentoLocalMiddlewareRequestHandler;
class ExperimentalMomentoLocalTestConfigMiddleware {
    constructor(metadata) {
        this.shouldLoadLate = true;
        this.metadata = metadata;
    }
    onNewRequest() {
        return new ExperimentalMomentoLocalMiddlewareRequestHandler(this.metadata);
    }
}
exports.ExperimentalMomentoLocalTestConfigMiddleware = ExperimentalMomentoLocalTestConfigMiddleware;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwZXJpbWVudGFsLW1vbWVudG8tbG9jYWwtdGVzdC1jb25maWctbWlkZGxld2FyZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb25maWcvbWlkZGxld2FyZS9leHBlcmltZW50YWwtbW9tZW50by1sb2NhbC10ZXN0LWNvbmZpZy1taWRkbGV3YXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQVFBLDBHQUFpRztBQUNqRyxvRUFBOEU7QUFFOUUsTUFBTSxnREFBZ0Q7SUFJcEQsWUFBWSxRQUFvRDtRQUM5RCxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztJQUMzQixDQUFDO0lBRUQsYUFBYSxDQUFDLE9BQTBCO1FBQ3RDLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQsaUJBQWlCLENBQUMsUUFBNEI7UUFDNUMsTUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQztRQUM1QyxLQUFLLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDeEQsSUFBSSxDQUFDLGVBQWUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFLEtBQWUsQ0FBQyxDQUFDO1NBQzFEO1FBQ0QsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRCxrQkFBa0IsQ0FDaEIsUUFBNEI7UUFFNUIsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRCxjQUFjLENBQ1osUUFBa0M7UUFFbEMsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxNQUF3QjtRQUN2QyxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVPLGVBQWUsQ0FDckIsUUFBa0IsRUFDbEIsR0FBVyxFQUNYLEtBQWU7UUFFZixJQUFJLEtBQUssS0FBSyxTQUFTO1lBQUUsT0FBTztRQUVoQyxJQUFJLFlBQW9CLENBQUM7UUFDekIsSUFBSSxjQUFzQixDQUFDO1FBRTNCLFFBQVEsR0FBRyxFQUFFO1lBQ1gsS0FBSyxXQUFXO2dCQUNkLFlBQVksR0FBRyxZQUFZLENBQUM7Z0JBQzVCLGNBQWMsR0FBRyxLQUFlLENBQUM7Z0JBQ2pDLE1BQU07WUFDUixLQUFLLGFBQWE7Z0JBQ2hCLFlBQVksR0FBRyxjQUFjLENBQUM7Z0JBQzlCLGNBQWMsR0FBRyx5RUFBaUMsQ0FBQyxPQUFPLENBQ3hELEtBQWUsQ0FDaEIsQ0FBQztnQkFDRixNQUFNO1lBQ1IsS0FBSyxXQUFXO2dCQUNkLFlBQVksR0FBRyxZQUFZLENBQUM7Z0JBQzVCLGNBQWMsR0FBSSxLQUFrQjtxQkFDakMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQ2Ysc0RBQWlDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUNyRDtxQkFDQSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2IsTUFBTTtZQUNSLEtBQUssWUFBWTtnQkFDZixZQUFZLEdBQUcsYUFBYSxDQUFDO2dCQUM3QixjQUFjLEdBQUksS0FBZ0IsQ0FBQyxRQUFRLEVBQUUsQ0FBQztnQkFDOUMsTUFBTTtZQUNSLEtBQUssV0FBVztnQkFDZCxZQUFZLEdBQUcsWUFBWSxDQUFDO2dCQUM1QixjQUFjLEdBQUksS0FBa0I7cUJBQ2pDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUNmLHNEQUFpQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FDckQ7cUJBQ0EsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNiLE1BQU07WUFDUixLQUFLLFNBQVM7Z0JBQ1osWUFBWSxHQUFHLFVBQVUsQ0FBQztnQkFDMUIsY0FBYyxHQUFJLEtBQWdCLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQzlDLE1BQU07WUFDUixLQUFLLFlBQVk7Z0JBQ2YsWUFBWSxHQUFHLGFBQWEsQ0FBQztnQkFDN0IsY0FBYyxHQUFJLEtBQWdCLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQzlDLE1BQU07WUFDUixLQUFLLGlCQUFpQjtnQkFDcEIsWUFBWSxHQUFHLG1CQUFtQixDQUFDO2dCQUNuQyxjQUFjLEdBQUksS0FBa0I7cUJBQ2pDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUNmLHNEQUFpQyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FDckQ7cUJBQ0EsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNiLE1BQU07WUFDUixLQUFLLGFBQWE7Z0JBQ2hCLFlBQVksR0FBRyxjQUFjLENBQUM7Z0JBQzlCLGNBQWMsR0FBRyxLQUFlLENBQUM7Z0JBQ2pDLE1BQU07WUFDUixLQUFLLHlCQUF5QjtnQkFDNUIsWUFBWSxHQUFHLDRCQUE0QixDQUFDO2dCQUM1QyxjQUFjLEdBQUksS0FBZ0IsQ0FBQyxRQUFRLEVBQUUsQ0FBQztnQkFDOUMsTUFBTTtZQUNSO2dCQUNFLFlBQVksR0FBRyxHQUFHLENBQUM7Z0JBQ25CLGNBQWMsR0FBRyxLQUFlLENBQUM7U0FDcEM7UUFFRCxRQUFRLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUMsQ0FBQztJQUM3QyxDQUFDO0NBQ0Y7QUErQkMsNEdBQWdEO0FBaEJsRCxNQUFNLDRDQUE0QztJQUdoRCxZQUFZLFFBQW9EO1FBQzlELElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO1FBQzNCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0lBQzNCLENBQUM7SUFFRCxZQUFZO1FBQ1YsT0FBTyxJQUFJLGdEQUFnRCxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUM3RSxDQUFDO0NBQ0Y7QUFHQyxvR0FBNEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge01ldGFkYXRhfSBmcm9tICdAZ3JwYy9ncnBjLWpzJztcbmltcG9ydCB7XG4gIE1pZGRsZXdhcmUsXG4gIE1pZGRsZXdhcmVNZXNzYWdlLFxuICBNaWRkbGV3YXJlTWV0YWRhdGEsXG4gIE1pZGRsZXdhcmVSZXF1ZXN0SGFuZGxlcixcbiAgTWlkZGxld2FyZVN0YXR1cyxcbn0gZnJvbSAnLi9taWRkbGV3YXJlJztcbmltcG9ydCB7TW9tZW50b0Vycm9yQ29kZU1ldGFkYXRhQ29udmVydGVyfSBmcm9tICcuLi9yZXRyeS9tb21lbnRvLWVycm9yLWNvZGUtbWV0YWRhdGEtY29udmVydGVyJztcbmltcG9ydCB7TW9tZW50b1JQQ01ldGhvZE1ldGFkYXRhQ29udmVydGVyfSBmcm9tICcuLi9yZXRyeS9tb21lbnRvLXJwYy1tZXRob2QnO1xuXG5jbGFzcyBFeHBlcmltZW50YWxNb21lbnRvTG9jYWxNaWRkbGV3YXJlUmVxdWVzdEhhbmRsZXJcbiAgaW1wbGVtZW50cyBNaWRkbGV3YXJlUmVxdWVzdEhhbmRsZXJcbntcbiAgcHJpdmF0ZSByZWFkb25seSBtZXRhZGF0YTogRXhwZXJpbWVudGFsTW9tZW50b0xvY2FsVGVzdENvbmZpZ01ldGFkYXRhO1xuICBjb25zdHJ1Y3RvcihtZXRhZGF0YTogRXhwZXJpbWVudGFsTW9tZW50b0xvY2FsVGVzdENvbmZpZ01ldGFkYXRhKSB7XG4gICAgdGhpcy5tZXRhZGF0YSA9IG1ldGFkYXRhO1xuICB9XG5cbiAgb25SZXF1ZXN0Qm9keShyZXF1ZXN0OiBNaWRkbGV3YXJlTWVzc2FnZSk6IFByb21pc2U8TWlkZGxld2FyZU1lc3NhZ2U+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlcXVlc3QpO1xuICB9XG5cbiAgb25SZXF1ZXN0TWV0YWRhdGEobWV0YWRhdGE6IE1pZGRsZXdhcmVNZXRhZGF0YSk6IFByb21pc2U8TWlkZGxld2FyZU1ldGFkYXRhPiB7XG4gICAgY29uc3QgZ3JwY01ldGFkYXRhID0gbWV0YWRhdGEuX2dycGNNZXRhZGF0YTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLm1ldGFkYXRhKSkge1xuICAgICAgdGhpcy5zZXRHcnBjTWV0YWRhdGEoZ3JwY01ldGFkYXRhLCBrZXksIHZhbHVlIGFzIHN0cmluZyk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobWV0YWRhdGEpO1xuICB9XG5cbiAgb25SZXNwb25zZU1ldGFkYXRhKFxuICAgIG1ldGFkYXRhOiBNaWRkbGV3YXJlTWV0YWRhdGFcbiAgKTogUHJvbWlzZTxNaWRkbGV3YXJlTWV0YWRhdGE+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1ldGFkYXRhKTtcbiAgfVxuXG4gIG9uUmVzcG9uc2VCb2R5KFxuICAgIHJlc3BvbnNlOiBNaWRkbGV3YXJlTWVzc2FnZSB8IG51bGxcbiAgKTogUHJvbWlzZTxNaWRkbGV3YXJlTWVzc2FnZSB8IG51bGw+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgfVxuXG4gIG9uUmVzcG9uc2VTdGF0dXMoc3RhdHVzOiBNaWRkbGV3YXJlU3RhdHVzKTogUHJvbWlzZTxNaWRkbGV3YXJlU3RhdHVzPiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzdGF0dXMpO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRHcnBjTWV0YWRhdGEoXG4gICAgbWV0YWRhdGE6IE1ldGFkYXRhLFxuICAgIGtleTogc3RyaW5nLFxuICAgIHZhbHVlPzogdW5rbm93blxuICApOiB2b2lkIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuXG4gICAgbGV0IGNvbnZlcnRlZEtleTogc3RyaW5nO1xuICAgIGxldCBjb252ZXJ0ZWRWYWx1ZTogc3RyaW5nO1xuXG4gICAgc3dpdGNoIChrZXkpIHtcbiAgICAgIGNhc2UgJ3JlcXVlc3RJZCc6XG4gICAgICAgIGNvbnZlcnRlZEtleSA9ICdyZXF1ZXN0LWlkJztcbiAgICAgICAgY29udmVydGVkVmFsdWUgPSB2YWx1ZSBhcyBzdHJpbmc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncmV0dXJuRXJyb3InOlxuICAgICAgICBjb252ZXJ0ZWRLZXkgPSAncmV0dXJuLWVycm9yJztcbiAgICAgICAgY29udmVydGVkVmFsdWUgPSBNb21lbnRvRXJyb3JDb2RlTWV0YWRhdGFDb252ZXJ0ZXIuY29udmVydChcbiAgICAgICAgICB2YWx1ZSBhcyBzdHJpbmdcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdlcnJvclJwY3MnOlxuICAgICAgICBjb252ZXJ0ZWRLZXkgPSAnZXJyb3ItcnBjcyc7XG4gICAgICAgIGNvbnZlcnRlZFZhbHVlID0gKHZhbHVlIGFzIHN0cmluZ1tdKVxuICAgICAgICAgIC5tYXAocnBjTWV0aG9kID0+XG4gICAgICAgICAgICBNb21lbnRvUlBDTWV0aG9kTWV0YWRhdGFDb252ZXJ0ZXIuY29udmVydChycGNNZXRob2QpXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCcgJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZXJyb3JDb3VudCc6XG4gICAgICAgIGNvbnZlcnRlZEtleSA9ICdlcnJvci1jb3VudCc7XG4gICAgICAgIGNvbnZlcnRlZFZhbHVlID0gKHZhbHVlIGFzIG51bWJlcikudG9TdHJpbmcoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdkZWxheVJwY3MnOlxuICAgICAgICBjb252ZXJ0ZWRLZXkgPSAnZGVsYXktcnBjcyc7XG4gICAgICAgIGNvbnZlcnRlZFZhbHVlID0gKHZhbHVlIGFzIHN0cmluZ1tdKVxuICAgICAgICAgIC5tYXAocnBjTWV0aG9kID0+XG4gICAgICAgICAgICBNb21lbnRvUlBDTWV0aG9kTWV0YWRhdGFDb252ZXJ0ZXIuY29udmVydChycGNNZXRob2QpXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCcgJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZGVsYXlNcyc6XG4gICAgICAgIGNvbnZlcnRlZEtleSA9ICdkZWxheS1tcyc7XG4gICAgICAgIGNvbnZlcnRlZFZhbHVlID0gKHZhbHVlIGFzIG51bWJlcikudG9TdHJpbmcoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdkZWxheUNvdW50JzpcbiAgICAgICAgY29udmVydGVkS2V5ID0gJ2RlbGF5LWNvdW50JztcbiAgICAgICAgY29udmVydGVkVmFsdWUgPSAodmFsdWUgYXMgbnVtYmVyKS50b1N0cmluZygpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3N0cmVhbUVycm9yUnBjcyc6XG4gICAgICAgIGNvbnZlcnRlZEtleSA9ICdzdHJlYW0tZXJyb3ItcnBjcyc7XG4gICAgICAgIGNvbnZlcnRlZFZhbHVlID0gKHZhbHVlIGFzIHN0cmluZ1tdKVxuICAgICAgICAgIC5tYXAocnBjTWV0aG9kID0+XG4gICAgICAgICAgICBNb21lbnRvUlBDTWV0aG9kTWV0YWRhdGFDb252ZXJ0ZXIuY29udmVydChycGNNZXRob2QpXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCcgJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3RyZWFtRXJyb3InOlxuICAgICAgICBjb252ZXJ0ZWRLZXkgPSAnc3RyZWFtLWVycm9yJztcbiAgICAgICAgY29udmVydGVkVmFsdWUgPSB2YWx1ZSBhcyBzdHJpbmc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3RyZWFtRXJyb3JNZXNzYWdlTGltaXQnOlxuICAgICAgICBjb252ZXJ0ZWRLZXkgPSAnc3RyZWFtLWVycm9yLW1lc3NhZ2UtbGltaXQnO1xuICAgICAgICBjb252ZXJ0ZWRWYWx1ZSA9ICh2YWx1ZSBhcyBudW1iZXIpLnRvU3RyaW5nKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29udmVydGVkS2V5ID0ga2V5O1xuICAgICAgICBjb252ZXJ0ZWRWYWx1ZSA9IHZhbHVlIGFzIHN0cmluZztcbiAgICB9XG5cbiAgICBtZXRhZGF0YS5zZXQoY29udmVydGVkS2V5LCBjb252ZXJ0ZWRWYWx1ZSk7XG4gIH1cbn1cblxuaW50ZXJmYWNlIEV4cGVyaW1lbnRhbE1vbWVudG9Mb2NhbFRlc3RDb25maWdNZXRhZGF0YSB7XG4gIHJlcXVlc3RJZDogc3RyaW5nO1xuICByZXR1cm5FcnJvcj86IHN0cmluZztcbiAgZXJyb3JScGNzPzogc3RyaW5nW107XG4gIGVycm9yQ291bnQ/OiBudW1iZXI7XG4gIGRlbGF5UnBjcz86IHN0cmluZ1tdO1xuICBkZWxheU1zPzogbnVtYmVyO1xuICBkZWxheUNvdW50PzogbnVtYmVyO1xuICBzdHJlYW1FcnJvclJwY3M/OiBzdHJpbmdbXTtcbiAgc3RyZWFtRXJyb3I/OiBzdHJpbmc7XG4gIHN0cmVhbUVycm9yTWVzc2FnZUxpbWl0PzogbnVtYmVyO1xufVxuXG5jbGFzcyBFeHBlcmltZW50YWxNb21lbnRvTG9jYWxUZXN0Q29uZmlnTWlkZGxld2FyZSBpbXBsZW1lbnRzIE1pZGRsZXdhcmUge1xuICBzaG91bGRMb2FkTGF0ZTogYm9vbGVhbjtcbiAgcHJpdmF0ZSByZWFkb25seSBtZXRhZGF0YTogRXhwZXJpbWVudGFsTW9tZW50b0xvY2FsVGVzdENvbmZpZ01ldGFkYXRhO1xuICBjb25zdHJ1Y3RvcihtZXRhZGF0YTogRXhwZXJpbWVudGFsTW9tZW50b0xvY2FsVGVzdENvbmZpZ01ldGFkYXRhKSB7XG4gICAgdGhpcy5zaG91bGRMb2FkTGF0ZSA9IHRydWU7XG4gICAgdGhpcy5tZXRhZGF0YSA9IG1ldGFkYXRhO1xuICB9XG5cbiAgb25OZXdSZXF1ZXN0KCk6IE1pZGRsZXdhcmVSZXF1ZXN0SGFuZGxlciB7XG4gICAgcmV0dXJuIG5ldyBFeHBlcmltZW50YWxNb21lbnRvTG9jYWxNaWRkbGV3YXJlUmVxdWVzdEhhbmRsZXIodGhpcy5tZXRhZGF0YSk7XG4gIH1cbn1cblxuZXhwb3J0IHtcbiAgRXhwZXJpbWVudGFsTW9tZW50b0xvY2FsVGVzdENvbmZpZ01pZGRsZXdhcmUsXG4gIEV4cGVyaW1lbnRhbE1vbWVudG9Mb2NhbFRlc3RDb25maWdNZXRhZGF0YSxcbiAgRXhwZXJpbWVudGFsTW9tZW50b0xvY2FsTWlkZGxld2FyZVJlcXVlc3RIYW5kbGVyLFxufTtcbiJdfQ==