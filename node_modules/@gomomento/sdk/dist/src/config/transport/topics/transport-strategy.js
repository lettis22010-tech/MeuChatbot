"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StaticTopicTransportStrategy = exports.StaticTopicGrpcConfiguration = void 0;
const topic_configurations_1 = require("../../topic-configurations");
class StaticTopicGrpcConfiguration {
    constructor(props) {
        if (props.numStreamClients !== undefined &&
            props.numStreamClients !== null) {
            this.numStreamClients = props.numStreamClients;
        }
        else {
            this.numStreamClients = topic_configurations_1.NUM_DEFAULT_STREAM_CLIENTS;
        }
        if (props.numUnaryClients !== undefined && props.numUnaryClients !== null) {
            this.numUnaryClients = props.numUnaryClients;
        }
        else {
            this.numUnaryClients = topic_configurations_1.NUM_DEFAULT_UNARY_CLIENTS;
        }
        if (props.numClients !== undefined && props.numClients !== null) {
            this.numClients = props.numClients;
        }
        this.keepAliveTimeMs = props.keepAliveTimeMs;
        this.keepAliveTimeoutMs = props.keepAliveTimeoutMs;
        this.keepAlivePermitWithoutCalls = props.keepAlivePermitWithoutCalls;
        this.deadlineMillis = props.deadlineMillis;
    }
    getNumClients() {
        return this.numClients;
    }
    getNumStreamClients() {
        return this.numStreamClients;
    }
    getNumUnaryClients() {
        return this.numUnaryClients;
    }
    withNumClients(numClients) {
        return new StaticTopicGrpcConfiguration({
            ...this,
            numClients,
        });
    }
    withNumStreamClients(numStreamClients) {
        return new StaticTopicGrpcConfiguration({
            ...this,
            numStreamClients,
        });
    }
    withNumUnaryClients(numUnaryClients) {
        return new StaticTopicGrpcConfiguration({
            ...this,
            numUnaryClients,
        });
    }
    getKeepAliveTimeoutMS() {
        return this.keepAliveTimeoutMs;
    }
    getKeepAliveTimeMS() {
        return this.keepAliveTimeMs;
    }
    getKeepAlivePermitWithoutCalls() {
        return this.keepAlivePermitWithoutCalls;
    }
    getDeadlineMillis() {
        return this.deadlineMillis;
    }
    withDeadlineMillis(deadlineMillis) {
        return new StaticTopicGrpcConfiguration({
            ...this,
            deadlineMillis,
        });
    }
}
exports.StaticTopicGrpcConfiguration = StaticTopicGrpcConfiguration;
class StaticTopicTransportStrategy {
    constructor(props) {
        this.grpcConfiguration = props.grpcConfiguration;
    }
    getGrpcConfig() {
        return this.grpcConfiguration;
    }
    withGrpcConfig(grpcConfiguration) {
        return new StaticTopicTransportStrategy({
            ...this,
            grpcConfiguration,
        });
    }
    withClientTimeoutMillis(clientTimeoutMillis) {
        return new StaticTopicTransportStrategy({
            ...this,
            grpcConfiguration: this.grpcConfiguration.withDeadlineMillis(clientTimeoutMillis),
        });
    }
}
exports.StaticTopicTransportStrategy = StaticTopicTransportStrategy;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNwb3J0LXN0cmF0ZWd5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbmZpZy90cmFuc3BvcnQvdG9waWNzL3RyYW5zcG9ydC1zdHJhdGVneS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFJQSxxRUFHb0M7QUFnQ3BDLE1BQWEsNEJBQTRCO0lBU3ZDLFlBQVksS0FBa0M7UUFDNUMsSUFDRSxLQUFLLENBQUMsZ0JBQWdCLEtBQUssU0FBUztZQUNwQyxLQUFLLENBQUMsZ0JBQWdCLEtBQUssSUFBSSxFQUMvQjtZQUNBLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUMsZ0JBQWdCLENBQUM7U0FDaEQ7YUFBTTtZQUNMLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxpREFBMEIsQ0FBQztTQUNwRDtRQUVELElBQUksS0FBSyxDQUFDLGVBQWUsS0FBSyxTQUFTLElBQUksS0FBSyxDQUFDLGVBQWUsS0FBSyxJQUFJLEVBQUU7WUFDekUsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUMsZUFBZSxDQUFDO1NBQzlDO2FBQU07WUFDTCxJQUFJLENBQUMsZUFBZSxHQUFHLGdEQUF5QixDQUFDO1NBQ2xEO1FBRUQsSUFBSSxLQUFLLENBQUMsVUFBVSxLQUFLLFNBQVMsSUFBSSxLQUFLLENBQUMsVUFBVSxLQUFLLElBQUksRUFBRTtZQUMvRCxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUM7U0FDcEM7UUFFRCxJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQyxlQUFlLENBQUM7UUFDN0MsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQztRQUNuRCxJQUFJLENBQUMsMkJBQTJCLEdBQUcsS0FBSyxDQUFDLDJCQUEyQixDQUFDO1FBQ3JFLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDLGNBQWMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsYUFBYTtRQUNYLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUN6QixDQUFDO0lBRUQsbUJBQW1CO1FBQ2pCLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDO0lBQy9CLENBQUM7SUFFRCxrQkFBa0I7UUFDaEIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDO0lBQzlCLENBQUM7SUFFRCxjQUFjLENBQUMsVUFBa0I7UUFDL0IsT0FBTyxJQUFJLDRCQUE0QixDQUFDO1lBQ3RDLEdBQUcsSUFBSTtZQUNQLFVBQVU7U0FDWCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsb0JBQW9CLENBQUMsZ0JBQXdCO1FBQzNDLE9BQU8sSUFBSSw0QkFBNEIsQ0FBQztZQUN0QyxHQUFHLElBQUk7WUFDUCxnQkFBZ0I7U0FDakIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELG1CQUFtQixDQUFDLGVBQXVCO1FBQ3pDLE9BQU8sSUFBSSw0QkFBNEIsQ0FBQztZQUN0QyxHQUFHLElBQUk7WUFDUCxlQUFlO1NBQ2hCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxxQkFBcUI7UUFDbkIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7SUFDakMsQ0FBQztJQUVELGtCQUFrQjtRQUNoQixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDOUIsQ0FBQztJQUVELDhCQUE4QjtRQUM1QixPQUFPLElBQUksQ0FBQywyQkFBMkIsQ0FBQztJQUMxQyxDQUFDO0lBRUQsaUJBQWlCO1FBQ2YsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQzdCLENBQUM7SUFFRCxrQkFBa0IsQ0FBQyxjQUFzQjtRQUN2QyxPQUFPLElBQUksNEJBQTRCLENBQUM7WUFDdEMsR0FBRyxJQUFJO1lBQ1AsY0FBYztTQUNmLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRjtBQTFGRCxvRUEwRkM7QUFFRCxNQUFhLDRCQUE0QjtJQUd2QyxZQUFZLEtBQWtDO1FBQzVDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUM7SUFDbkQsQ0FBQztJQUVELGFBQWE7UUFDWCxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztJQUNoQyxDQUFDO0lBRUQsY0FBYyxDQUNaLGlCQUF5QztRQUV6QyxPQUFPLElBQUksNEJBQTRCLENBQUM7WUFDdEMsR0FBRyxJQUFJO1lBQ1AsaUJBQWlCO1NBQ2xCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCx1QkFBdUIsQ0FDckIsbUJBQTJCO1FBRTNCLE9BQU8sSUFBSSw0QkFBNEIsQ0FBQztZQUN0QyxHQUFHLElBQUk7WUFDUCxpQkFBaUIsRUFDZixJQUFJLENBQUMsaUJBQWlCLENBQUMsa0JBQWtCLENBQUMsbUJBQW1CLENBQUM7U0FDakUsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGO0FBN0JELG9FQTZCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIFRvcGljR3JwY0NvbmZpZ3VyYXRpb24sXG4gIFRvcGljR3JwY0NvbmZpZ3VyYXRpb25Qcm9wcyxcbn0gZnJvbSAnLi9ncnBjLWNvbmZpZ3VyYXRpb24nO1xuaW1wb3J0IHtcbiAgTlVNX0RFRkFVTFRfU1RSRUFNX0NMSUVOVFMsXG4gIE5VTV9ERUZBVUxUX1VOQVJZX0NMSUVOVFMsXG59IGZyb20gJy4uLy4uL3RvcGljLWNvbmZpZ3VyYXRpb25zJztcblxuZXhwb3J0IGludGVyZmFjZSBUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgLyoqXG4gICAqIENvbmZpZ3VyZXMgdGhlIGxvdy1sZXZlbCBnUlBDIHNldHRpbmdzIGZvciB0aGUgTW9tZW50byBjbGllbnQncyBjb21tdW5pY2F0aW9uXG4gICAqIHdpdGggdGhlIE1vbWVudG8gc2VydmVyLlxuICAgKiBAcmV0dXJucyB7VG9waWNHcnBjQ29uZmlndXJhdGlvbn1cbiAgICovXG4gIGdldEdycGNDb25maWcoKTogVG9waWNHcnBjQ29uZmlndXJhdGlvbjtcblxuICAvKipcbiAgICogQ29weSBjb25zdHJ1Y3RvciBmb3Igb3ZlcnJpZGluZyB0aGUgZ1JQQyBjb25maWd1cmF0aW9uXG4gICAqIEBwYXJhbSB7VG9waWNHcnBjQ29uZmlndXJhdGlvbn0gZ3JwY0NvbmZpZ1xuICAgKiBAcmV0dXJucyB7VG9waWNUcmFuc3BvcnRTdHJhdGVneX0gYSBuZXcgVHJhbnNwb3J0U3RyYXRlZ3kgd2l0aCB0aGUgc3BlY2lmaWVkIGdSUEMgY29uZmlnLlxuICAgKi9cbiAgd2l0aEdycGNDb25maWcoZ3JwY0NvbmZpZzogVG9waWNHcnBjQ29uZmlndXJhdGlvbik6IFRvcGljVHJhbnNwb3J0U3RyYXRlZ3k7XG5cbiAgLyoqXG4gICAqIENvcHkgY29uc3RydWN0b3IgdG8gdXBkYXRlIHRoZSBjbGllbnQtc2lkZSB0aW1lb3V0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjbGllbnRUaW1lb3V0TWlsbGlzXG4gICAqIEByZXR1cm5zIHtUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5fSBhIG5ldyBUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5IHdpdGggdGhlIHNwZWNpZmllZCBjbGllbnQgdGltZW91dFxuICAgKi9cbiAgd2l0aENsaWVudFRpbWVvdXRNaWxsaXMoY2xpZW50VGltZW91dE1pbGxpczogbnVtYmVyKTogVG9waWNUcmFuc3BvcnRTdHJhdGVneTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5UHJvcHMge1xuICAvKipcbiAgICogbG93LWxldmVsIGdSUEMgc2V0dGluZ3MgZm9yIGNvbW11bmljYXRpb24gd2l0aCB0aGUgTW9tZW50byBzZXJ2ZXJcbiAgICovXG4gIGdycGNDb25maWd1cmF0aW9uOiBUb3BpY0dycGNDb25maWd1cmF0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgU3RhdGljVG9waWNHcnBjQ29uZmlndXJhdGlvbiBpbXBsZW1lbnRzIFRvcGljR3JwY0NvbmZpZ3VyYXRpb24ge1xuICBwcml2YXRlIHJlYWRvbmx5IG51bUNsaWVudHM6IG51bWJlcjtcbiAgcHJpdmF0ZSByZWFkb25seSBudW1TdHJlYW1DbGllbnRzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgbnVtVW5hcnlDbGllbnRzOiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkga2VlcEFsaXZlUGVybWl0V2l0aG91dENhbGxzPzogbnVtYmVyO1xuICBwcml2YXRlIHJlYWRvbmx5IGtlZXBBbGl2ZVRpbWVvdXRNcz86IG51bWJlcjtcbiAgcHJpdmF0ZSByZWFkb25seSBrZWVwQWxpdmVUaW1lTXM/OiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGVhZGxpbmVNaWxsaXM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVG9waWNHcnBjQ29uZmlndXJhdGlvblByb3BzKSB7XG4gICAgaWYgKFxuICAgICAgcHJvcHMubnVtU3RyZWFtQ2xpZW50cyAhPT0gdW5kZWZpbmVkICYmXG4gICAgICBwcm9wcy5udW1TdHJlYW1DbGllbnRzICE9PSBudWxsXG4gICAgKSB7XG4gICAgICB0aGlzLm51bVN0cmVhbUNsaWVudHMgPSBwcm9wcy5udW1TdHJlYW1DbGllbnRzO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm51bVN0cmVhbUNsaWVudHMgPSBOVU1fREVGQVVMVF9TVFJFQU1fQ0xJRU5UUztcbiAgICB9XG5cbiAgICBpZiAocHJvcHMubnVtVW5hcnlDbGllbnRzICE9PSB1bmRlZmluZWQgJiYgcHJvcHMubnVtVW5hcnlDbGllbnRzICE9PSBudWxsKSB7XG4gICAgICB0aGlzLm51bVVuYXJ5Q2xpZW50cyA9IHByb3BzLm51bVVuYXJ5Q2xpZW50cztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5udW1VbmFyeUNsaWVudHMgPSBOVU1fREVGQVVMVF9VTkFSWV9DTElFTlRTO1xuICAgIH1cblxuICAgIGlmIChwcm9wcy5udW1DbGllbnRzICE9PSB1bmRlZmluZWQgJiYgcHJvcHMubnVtQ2xpZW50cyAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5udW1DbGllbnRzID0gcHJvcHMubnVtQ2xpZW50cztcbiAgICB9XG5cbiAgICB0aGlzLmtlZXBBbGl2ZVRpbWVNcyA9IHByb3BzLmtlZXBBbGl2ZVRpbWVNcztcbiAgICB0aGlzLmtlZXBBbGl2ZVRpbWVvdXRNcyA9IHByb3BzLmtlZXBBbGl2ZVRpbWVvdXRNcztcbiAgICB0aGlzLmtlZXBBbGl2ZVBlcm1pdFdpdGhvdXRDYWxscyA9IHByb3BzLmtlZXBBbGl2ZVBlcm1pdFdpdGhvdXRDYWxscztcbiAgICB0aGlzLmRlYWRsaW5lTWlsbGlzID0gcHJvcHMuZGVhZGxpbmVNaWxsaXM7XG4gIH1cblxuICBnZXROdW1DbGllbnRzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubnVtQ2xpZW50cztcbiAgfVxuXG4gIGdldE51bVN0cmVhbUNsaWVudHMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5udW1TdHJlYW1DbGllbnRzO1xuICB9XG5cbiAgZ2V0TnVtVW5hcnlDbGllbnRzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMubnVtVW5hcnlDbGllbnRzO1xuICB9XG5cbiAgd2l0aE51bUNsaWVudHMobnVtQ2xpZW50czogbnVtYmVyKTogVG9waWNHcnBjQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBTdGF0aWNUb3BpY0dycGNDb25maWd1cmF0aW9uKHtcbiAgICAgIC4uLnRoaXMsXG4gICAgICBudW1DbGllbnRzLFxuICAgIH0pO1xuICB9XG5cbiAgd2l0aE51bVN0cmVhbUNsaWVudHMobnVtU3RyZWFtQ2xpZW50czogbnVtYmVyKTogVG9waWNHcnBjQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBTdGF0aWNUb3BpY0dycGNDb25maWd1cmF0aW9uKHtcbiAgICAgIC4uLnRoaXMsXG4gICAgICBudW1TdHJlYW1DbGllbnRzLFxuICAgIH0pO1xuICB9XG5cbiAgd2l0aE51bVVuYXJ5Q2xpZW50cyhudW1VbmFyeUNsaWVudHM6IG51bWJlcik6IFRvcGljR3JwY0NvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiBuZXcgU3RhdGljVG9waWNHcnBjQ29uZmlndXJhdGlvbih7XG4gICAgICAuLi50aGlzLFxuICAgICAgbnVtVW5hcnlDbGllbnRzLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0S2VlcEFsaXZlVGltZW91dE1TKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMua2VlcEFsaXZlVGltZW91dE1zO1xuICB9XG5cbiAgZ2V0S2VlcEFsaXZlVGltZU1TKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMua2VlcEFsaXZlVGltZU1zO1xuICB9XG5cbiAgZ2V0S2VlcEFsaXZlUGVybWl0V2l0aG91dENhbGxzKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMua2VlcEFsaXZlUGVybWl0V2l0aG91dENhbGxzO1xuICB9XG5cbiAgZ2V0RGVhZGxpbmVNaWxsaXMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5kZWFkbGluZU1pbGxpcztcbiAgfVxuXG4gIHdpdGhEZWFkbGluZU1pbGxpcyhkZWFkbGluZU1pbGxpczogbnVtYmVyKTogU3RhdGljVG9waWNHcnBjQ29uZmlndXJhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBTdGF0aWNUb3BpY0dycGNDb25maWd1cmF0aW9uKHtcbiAgICAgIC4uLnRoaXMsXG4gICAgICBkZWFkbGluZU1pbGxpcyxcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3RhdGljVG9waWNUcmFuc3BvcnRTdHJhdGVneSBpbXBsZW1lbnRzIFRvcGljVHJhbnNwb3J0U3RyYXRlZ3kge1xuICBwcml2YXRlIHJlYWRvbmx5IGdycGNDb25maWd1cmF0aW9uOiBUb3BpY0dycGNDb25maWd1cmF0aW9uO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5UHJvcHMpIHtcbiAgICB0aGlzLmdycGNDb25maWd1cmF0aW9uID0gcHJvcHMuZ3JwY0NvbmZpZ3VyYXRpb247XG4gIH1cblxuICBnZXRHcnBjQ29uZmlnKCk6IFRvcGljR3JwY0NvbmZpZ3VyYXRpb24ge1xuICAgIHJldHVybiB0aGlzLmdycGNDb25maWd1cmF0aW9uO1xuICB9XG5cbiAgd2l0aEdycGNDb25maWcoXG4gICAgZ3JwY0NvbmZpZ3VyYXRpb246IFRvcGljR3JwY0NvbmZpZ3VyYXRpb25cbiAgKTogU3RhdGljVG9waWNUcmFuc3BvcnRTdHJhdGVneSB7XG4gICAgcmV0dXJuIG5ldyBTdGF0aWNUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5KHtcbiAgICAgIC4uLnRoaXMsXG4gICAgICBncnBjQ29uZmlndXJhdGlvbixcbiAgICB9KTtcbiAgfVxuXG4gIHdpdGhDbGllbnRUaW1lb3V0TWlsbGlzKFxuICAgIGNsaWVudFRpbWVvdXRNaWxsaXM6IG51bWJlclxuICApOiBTdGF0aWNUb3BpY1RyYW5zcG9ydFN0cmF0ZWd5IHtcbiAgICByZXR1cm4gbmV3IFN0YXRpY1RvcGljVHJhbnNwb3J0U3RyYXRlZ3koe1xuICAgICAgLi4udGhpcyxcbiAgICAgIGdycGNDb25maWd1cmF0aW9uOlxuICAgICAgICB0aGlzLmdycGNDb25maWd1cmF0aW9uLndpdGhEZWFkbGluZU1pbGxpcyhjbGllbnRUaW1lb3V0TWlsbGlzKSxcbiAgICB9KTtcbiAgfVxufVxuIl19